<!DOCTYPE html>
<!-- saved from url=(0035)http://js1k.com/pleaseDontHotlinkMe -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>JS1k, 1k demo submission [premasagar]</title>
		<meta charset="utf-8">
		<script>
		    var _ = function(){console.log.apply(console, arguments);};
		</script>
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
		(function(){
			var win = this,
			    setInterval = win.setInterval,
			    M = Math,
			    PI = M.PI,
			    PHI = 1.618,
			    phi = 1 / PHI,
			    RGBMAX = 255,
			    ceil = M.ceil,
			    random = M.random,
			    doc = document,
			    body = doc.body,
			    bodyStyle = body.style,
			    canvas = doc.getElementById('c'),
			    ctx = canvas.getContext('2d'),
			    w = canvas.width = win.innerWidth,
			    h = canvas.height = win.innerHeight,
			    fps = 25,
			    steps = 50,
			    factor = PHI, //1 + PHI / (PHI * PHI),
			    dirX = 1,
			    dirY = dirX,
			    minX = 400,
			    minY = minX,
			    maxRadius = 100,
			    x, y,
			    toneSeed = random(),
			    tone = toneSeed >= 0.5 ?
			        'r' :
			        (toneSeed <= 0.3) ?
		            'b' :
		            'g',
			    r = g = b = RGBMAX,
			    intervalRef,
			    
			    rgba = 'rgba(',
			    strokeStyle = 'strokeStyle',
			    stroke = 'stroke',
			    beginPath = 'beginPath',
			    closePath = 'closePath';
			    
			function draw(){
			    var drift = random() + phi / 2,
			        intensity, radius, posX, posY;
			    
			    function colorComponent(color){
			        win[color] = ceil(
			            color == tone ?
			                intensity * RGBMAX :
			                RGBMAX - win[color] * drift
			        );
			    }
			    
			    // direction & coords
			    if (x > w - maxRadius / 2){
			        dirX = -dirX;
			    }
			    if (y > h - maxRadius / 2){
			        dirY = -dirY;
			    }
			    if (x <= minX){
			        x = minX;
			        dirX = 1;
			    }
			    if (y <= minY){
			        y = minY;
			        dirY = 1;
			    }
			    x = ceil(dirX > 0 ? x * factor : (x / factor) * drift);
			    y = ceil(dirY > 0 ? y * factor : (y / factor) * drift);
		        intensity = x / w;
			    
			    // color
		        colorComponent('r');
		        colorComponent('g');
		        colorComponent('b');
		        
		        // radius
		        radius = ceil(intensity * maxRadius * drift);
		        
		        // positions
		        posX = ceil(x - minX - radius / 2);
		        posY = ceil(y - minY - radius / 2);
		        
		        if (posX > w || posY > h){
		            return [ceil(w / PHI) * drift, ceil(h / PHI) * drift];
		        }
			    
			    // paths
			    ctx[beginPath]();
                ctx.arc(posX, posY, radius, 0, PI * 2, false);
                ctx[closePath]();
		        
		        // styles
                ctx[strokeStyle] = rgba+ g +','+ g +','+ b +','+ phi * drift +')';
			    ctx.fillStyle = rgba+ r +','+ g +','+ b +','+ (phi * phi * phi * drift) +')';
			    
			    // draw
			    ctx[stroke]();
                ctx.fill();
		        
		        return [posX, posY];
			}
            
            function render(){
                var coords = [],
                    i = 0, xy;
                
                // draw circles, in a number of steps
                for (; i < steps; i++){
                    coords[i] = draw();
                }
                
                // draw connecting lines
                ctx[beginPath]();
                xy = coords[0];
                ctx.moveTo(xy[0], xy[1]);
                
                for (i = steps; i; i--){
                    xy = coords[i-1];
                    ctx.lineTo(xy[0], xy[1]);
                }
                ctx[closePath]();
                ctx[strokeStyle] = rgba+'0,0,0,0.1)';
                ctx[stroke]();
			}
			
			bodyStyle.cssText = 'margin:0;background-color:#000;overflow:hidden';
			
			x = ceil(w * random());
			y = ceil(h * random());
			intervalRef = setInterval(render, 1000 / fps);
			
			// DEV:
			// toggle animation
			canvas.onclick = doc.onkeydown = function(event){
			    var which = event.which;
                if (which == 1 || which == 32){ // click or SPACE key
                    if (intervalRef){
        			    win.clearInterval(intervalRef);
        			    intervalRef = null;
        			}
        			else {
        			    intervalRef = setInterval(render, 1000 / fps)
        			}
                }
            };
        }());
		</script>
	
</body></html>
